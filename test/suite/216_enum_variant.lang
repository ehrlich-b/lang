// expect: 42
// Test: Enum variant construction
// Verifies variant construction works for both unit and payload variants

include "std/core.lang"

enum Option {
    None,
    Some(i64),
}

func main() i64 {
    // Test unit variant construction
    var none Option = Option.None;

    // Test variant with payload
    var some Option = Option.Some(42);

    // Access memory layout directly: [tag:8][payload:8]
    var tag_ptr *i64 = &some;
    var tag i64 = *tag_ptr;

    // Payload is at offset +1 (8 bytes for i64 pointer arithmetic)
    var payload_ptr *i64 = tag_ptr + 1;
    var payload i64 = *payload_ptr;

    // tag should be 1 (Some is second variant), payload should be 42
    if tag != 1 {
        return 1;  // Wrong tag
    }
    return payload;
}
